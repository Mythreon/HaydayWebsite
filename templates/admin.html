{% extends 'base.html' %}
{% block title %}Admin Panel{% endblock %}

{% block head_extra %}
  <style>
.dashboard-wrapper {
  display: flex;
  flex-direction: row;
  min-height: 100vh;
  margin-top: 60px;
}

.sidebar {
  width: 240px;
  background-color: #222;
  color: white;
  padding: 20px;
  font-family: sans-serif;
}

.sidebar h2 {
  font-size: 20px;
  margin-bottom: 16px;
}

.sidebar a {
  display: block;
  color: white;
  text-decoration: none;
  margin: 8px 0;
  padding: 8px 12px;
  border-radius: 6px;
  transition: background 0.2s;
}

.sidebar a:hover {
  background-color: #333;
}

.dashboard-content {
  flex-grow: 1;
  padding: 40px;
  background-color: #f4f4f4;
  display: flex;
  flex-direction: column;
  gap: 30px;
}
body.dark .dashboard-content {
  background-color: #1e1e1e;
}

.card {
  background: #1f1f1f;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
  width: 100%;
  max-width: 900px;
  margin: auto;
}
.card h3 {
  margin-bottom: 16px;
  font-size: 16px;
}

.card .log-entry {
  max-height: 180px;
  overflow-y: auto;
  white-space: pre-wrap;
  background: #2a2a2a;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 6px;
}
.log-entry {
  font-size: 13px;
}


body.dark .card {
  background: #1f1f1f;
  color: white;
}


.toggle-row {
  display: grid;
  grid-template-columns: 180px 140px 1fr;
  gap: 12px;
  align-items: center;
  margin-bottom: 14px;
}

.toggle-row label {
  font-weight: bold;
}

.toggle-row select,
.toggle-row input[type="text"],
#prefix-input {
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 14px;
  width: 100%;
  box-sizing: border-box;
}

body.dark .toggle-row select,
body.dark .toggle-row input[type="text"],
body.dark #prefix-input {
  background-color: #1e1e1e;
  color: #eee;
  border: 1px solid #444;
}

button {
  margin-top: 10px;
  padding: 8px 14px;
  font-size: 14px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  background-color: #4caf50;
  color: white;
}

button:hover {
  background-color: #3e9141;
}

#save-status {
  font-weight: bold;
  margin-top: 8px;
}

@media (max-width: 768px) {
  .dashboard-wrapper {
    flex-direction: column;
  }

  .sidebar {
    width: 100%;
    padding: 15px;
    text-align: center;
  }

  .sidebar a {
    display: inline-block;
    margin: 6px;
    font-size: 15px;
  }

  .dashboard-content {
    padding: 20px;
  }

  .toggle-row {
    grid-template-columns: 1fr;
    gap: 10px;
  }
  .card {
  padding: 16px;
  margin: 12px;
  }
}

.grid-results {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 24px;
  align-items: start;
  width: 100%;
  margin-inline: auto;
}


.card {
  background: #1f1f1f;
  padding: 20px;
  font-size: 14px;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
  width: 100%;
  max-width: 100%;
  margin: 0;
  overflow: hidden;
}
.results-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
  gap: 20px;
  margin-top: 20px;
  align-items: start;
}
.results-list {
  display: flex;
  flex-direction: column;
  gap: 24px;
  width: 100%;
}

.result-row {
  background: #1f1f1f;
  border: 1px solid #333;
  padding: 20px;
  border-radius: 10px;
  color: white;
}

.result-row .row-title {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 10px;
  color: #7abfff;
}

.result-row .row-content {
  font-size: 14px;
  line-height: 1.5;
}

.card-list {
  display: flex;
  flex-direction: column;
  gap: 24px;
  width: 100%;
}

.wide-card {
  background: #1f1f1f;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  padding: 20px;
  display: flex;
  flex-direction: row;
  gap: 30px;
  align-items: flex-start;
  flex-wrap: wrap;
}

.card-header {
  font-weight: bold;
  font-size: 16px;
  min-width: 180px;
  color: #7abfff;
}

.card-body {
  flex: 1;
  font-size: 14px;
  line-height: 1.5;
}
.log-row {
  padding: 10px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  transition: background 0.2s;
}
.log-row:hover {
  background-color: #2a2a2a;
}
.log-row div {
  margin-bottom: 4px;
}
.log-row .log-full {
  display: none;
  margin-top: 6px;
  padding-top: 6px;
  border-top: 1px dashed #555;
  font-size: 13px;
  color: #bbb;
}
.log-row.expanded .log-full {
  display: block;
}
.card-body table {
  font-size: 13px;
  color: #ccc;
}

.card-body th, .card-body td {
  border-bottom: 1px solid #333;
  padding: 6px;
}

.card-body th {
  color: #7abfff;
  font-weight: 600;
}

.pagination {
  margin-top: 10px;
  font-size: 12px;
  color: #aaa;
}
.modal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.75);
  display: flex; align-items: center; justify-content: center;
  z-index: 1000;
}
.modal-content {
  background: #1f1f1f;
  padding: 20px;
  border-radius: 8px;
  color: white;
}
.modal-content input {
  display: block;
  margin-bottom: 12px;
  padding: 8px;
  width: 100%;
  background: #2a2a2a;
  border: 1px solid #444;
  color: white;
}
.admin-panel-card {
  background-color: #1f1f1f;
  border: 1px solid #333;
  border-radius: 12px;
  padding: 40px;
  margin-inline: auto;
  margin-top: 100px;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  text-align: center;
  max-width: 520px;
  width: 90%;
}

.admin-title {
  font-size: 26px;
  color: #fff;
  margin-bottom: 12px;
}

.admin-subtitle {
  color: #aaa;
  font-size: 14px;
  margin-bottom: 28px;
}

.search-bar-wrapper {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
}

.search-bar-wrapper input {
  flex: 1;
  min-width: 240px;
  padding: 10px 15px;
  border-radius: 8px;
  border: 1px solid #444;
  background-color: #111;
  color: #fff;
  font-size: 15px;
}

.search-bar-wrapper button {
  background-color: #4caf50;
  color: white;
  padding: 10px 18px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.search-bar-wrapper button:hover {
  background-color: #3e9141;
}


  </style>
{% endblock %}

{% block content %}
  <div class="dashboard-wrapper">
{% include 'sidepanel.html' %}

    <main class="dashboard-content">
    <div class="admin-panel-card">
      <h1 class="admin-title">üõ† Admin Panel</h1>
      <p class="admin-subtitle">Search for a user using Discord ID </p>
      <div class="search-bar-wrapper">
        <input type="text" id="lookupInput" placeholder="üîç Enter Discord ID..." />
        <button onclick="performLookup()">Search</button>
      </div>
    </div>


      <div id="results" class="results-grid"></div>
    </main>
  </div>

<div id="muteModal" style="display: none;" class="modal-overlay">
  <div class="modal-content">
    <h3>üîá Mute User</h3>
    <input id="muteDuration" placeholder="e.g. 1h or 30m">
    <input id="muteReason" placeholder="Reason (optional)">
    <button onclick="confirmMute()">‚úÖ Confirm</button>
    <button onclick="closeMuteModal()">‚ùå Cancel</button>
  </div>
</div>

{% endblock %}

{% block scripts %}
<script>
  const CURRENT_USER_ID_FROM_SESSION = "{{ session['discord_id'] }}";
</script>

  <script>
let muteUserId = null;

function scamAction(id, action) {
  if (action === "mute") {
    muteUserId = id;
    document.getElementById("muteModal").style.display = "flex";
    return;
  }

  const actionLabels = {
    "ban": "Are you sure you want to ban this user?",
    "unban": "Unban this user?",
    "unmute": "Unmute this user?"
  };

  let reason = "Actioned via admin panel";
  if (action === "ban" || action === "unban") {
    reason = prompt(action === "ban" ? "Enter reason for ban:" : "Enter reason for unban:", "No reason provided");
    if (!reason) return; // Cancelled or empty
  }
  if (action === "unmute") {
    reason = prompt("Enter reason for unmute:", "No reason provided");
    if (!reason) return;
  }


  if (action === "ban" || action === "unban") {
    // Ban API
    fetch("/api/moderation/ban", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        user_id: id,
        action: action,
        reason: reason,
        staff_id: CURRENT_USER_ID_FROM_SESSION
      })
    })
    .then(res => res.json())
    .then(result => {
      if (result.success) {
        alert(`‚úÖ ${action === "ban" ? "Banned" : "Unbanned"} successfully.`);
        performLookup(); // Refresh user info
      } else {
        alert("‚ùå Error: " + (result.error || "Unknown error"));
      }
    })
    .catch(err => {
      console.error("Ban/Unban error:", err);
      alert("‚ùå Network or server error.");
    });
  }

  if (action === "unmute") {
    // Mute API with unmute mode
    fetch("/api/moderation/mute", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        user_id: id,
        action: "unmute",
        reason: "Unmuted via admin panel",
        staff_id: CURRENT_USER_ID_FROM_SESSION
      })
    })
    .then(res => res.json())
    .then(result => {
      if (result.success) {
        alert("‚úÖ Unmuted successfully.");
        performLookup(); // Refresh user info
      } else {
        alert("‚ùå Error: " + (result.error || "Unknown error"));
      }
    })
    .catch(err => {
      console.error("Unmute error:", err);
      alert("‚ùå Network or server error.");
    });
  }
  if (action === "kick") {
    const reason = prompt("Enter reason for kick:", "No reason provided");
    if (!reason) return;

    fetch("/api/moderation/kick", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        user_id: id,
        reason,
        staff_id: CURRENT_USER_ID_FROM_SESSION
      })
    })
    .then(res => res.json())
    .then(result => {
      if (result.success) {
        alert("‚úÖ Kicked successfully.");
        performLookup();
      } else {
        alert("‚ùå Error: " + (result.error || "Unknown error"));
      }
    })
    .catch(err => {
      console.error("Kick error:", err);
      alert("‚ùå Network or server error.");
    });
  }
}



function closeMuteModal() {
  const modal = document.getElementById("muteModal");
  modal.style.display = "none";
  modal.querySelector(".modal-content").innerHTML = originalMuteModalHTML;
  document.getElementById("muteDuration").value = "";
  document.getElementById("muteReason").value = "";
  muteUserId = null;
}


async function confirmMute() {
  const duration = document.getElementById("muteDuration").value.trim();
  const reason = document.getElementById("muteReason").value.trim();

  if (!duration) {
    alert("Please provide a duration.");
    return;
  }

  const res = await fetch("/api/moderation/mute", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      user_id: muteUserId,
      duration,
      reason,
      staff_id: CURRENT_USER_ID_FROM_SESSION
    })
  });

  const result = await res.json();
  if (result.success) {
    const modal = document.getElementById("muteModal");
    modal.querySelector(".modal-content").innerHTML = `
      <p style="color: lime;">‚úÖ Mute submitted. Bot will apply it shortly.</p>
    `;
    setTimeout(closeMuteModal, 1500);
  } else {
    alert(`‚ùå Error: ${result.error}`);
  }
}


let currentPages = {
  edits: 1,
  deletes: 1,
  names: 1
};
let cachedData = null;

function changeLogPage(type, page) {
  if (!cachedData) return;

  currentPages[type] = page;
  updateCardSection(type);
}

function updateCardSection(type) {
  if (!cachedData) return;

  const container = document.querySelector(`.card-body-${type}`);
  if (!container) return;

  let html = "";
  if (type === "edits")
    html = renderLogList(cachedData.messages_edited, ["before", "after", "timestamp"], currentPages.edits, 10, "edits");
  if (type === "deletes")
    html = renderLogList(cachedData.messages_deleted, ["content", "timestamp"], currentPages.deletes, 10, "deletes");
  if (type === "names")
    html = renderLogList(cachedData.name_history, ["before", "after", "timestamp"], currentPages.names, 10, "names");

  container.innerHTML = html;
}


  function createCard(title, contentHTML) {
    return `
      <div class="card">
        <h3 style="margin-bottom: 12px; font-size: 18px; color: #ddd;">${title}</h3>
        ${contentHTML || "<p style='color: gray;'>No data</p>"}
      </div>
    `;
  }



function renderLogList(logs, keysToShow = [], page = 1, perPage = 10, type = "edits") {
  if (!logs?.length) return "<p style='color: gray;'>No logs available.</p>";

  // ‚úÖ Sort newest first
  logs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

  const start = (page - 1) * perPage;
  const paginated = logs.slice(start, start + perPage);
  const totalPages = Math.ceil(logs.length / perPage);

  const headers = keysToShow.length ? keysToShow : Object.keys(paginated[0] || {});
  const headerRow = headers.map(h => `<th style="text-align:left; padding: 6px;">${h}</th>`).join("");

  const rows = paginated.map(log => {
    return `<tr>${headers.map(k => {
      let val = log[k];

      // ‚úÖ Format timestamp
      if (k === "timestamp" && val) {
        const d = new Date(val);
        const yyyy = d.getFullYear();
        const mm = String(d.getMonth() + 1).padStart(2, '0');
        const dd = String(d.getDate()).padStart(2, '0');
        const hh = String(d.getHours()).padStart(2, '0');
        const min = String(d.getMinutes()).padStart(2, '0');
        val = `${yyyy}-${mm}-${dd} ${hh}:${min}`;
      }

      return `<td style="padding: 6px;">${truncate(val)}</td>`;
    }).join("")}</tr>`;
  }).join("");

  const nav = totalPages > 1
    ? `<div class="pagination">
        Page ${page} of ${totalPages}
        <button onclick="changeLogPage('${type}', ${page - 1})" ${page === 1 ? 'disabled' : ''}>‚óÄ</button>
        <button onclick="changeLogPage('${type}', ${page + 1})" ${page === totalPages ? 'disabled' : ''}>‚ñ∂</button>
      </div>`
    : "";

  return `
    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
      <thead><tr style="border-bottom: 1px solid #555;">${headerRow}</tr></thead>
      <tbody>${rows}</tbody>
    </table>
    ${nav}
  `;
}





  function truncate(text, limit = 250) {
    if (!text) return "";
    return typeof text === "string" && text.length > limit ? text.slice(0, limit) + "‚Ä¶" : text;
  }

    function renderLinkedData(entry) {
      if (!entry) return "<p style='color: gray;'>No data</p>";
      return `
        <div><strong>Discord ID:</strong> ${entry._id}</div>
        <div><strong>Hay Day ID:</strong> ${entry.hay_day_id}</div>
        <div><strong>IP:</strong> ${entry.ip}</div>
        <div><strong>Fingerprint:</strong> ${entry.fingerprint}</div>
        <div><strong>User Agent:</strong> ${entry.user_agent?.slice(0, 100)}...</div>
        <div><strong>Submitted:</strong> ${new Date(entry.submitted_at).toLocaleString()}</div>
      `;
    }

function renderUserSummary(summary) {
  if (!summary) return "<p style='color: gray;'>No summary available</p>";

  const avatar = summary.avatar_url
    ? `<img src="${summary.avatar_url}" alt="avatar" style="width: 90px; height: 90px; border-radius: 50%; object-fit: cover; border: 2px solid #333;">`
    : "";

  const muteButton = summary.muted
    ? `<button onclick="if(confirm('Are you sure you want to unmute this user?')) scamAction('${summary.user_id}', 'unmute')">üîì Unmute</button>`
    : `<button onclick="scamAction('${summary.user_id}', 'mute')">üîá Mute</button>`;

  const banButton = summary.banned
    ? `<button onclick="scamAction('${summary.user_id}', 'unban')">‚ôªÔ∏è Unban</button>`
    : `<button onclick="scamAction('${summary.user_id}', 'ban')">üî® Ban</button>`

  return `
    <div style="display: flex; flex-direction: row; gap: 24px;">
      <div style="min-width: 100px;">${avatar}</div>
      <div style="flex: 1;">
        <div><strong>Display Name:</strong> ${summary.display_name || "N/A"}</div>
        <div><strong>Username:</strong> ${summary.username || "N/A"}</div>
        <div><strong>User ID:</strong> 
          <a href="https://discord.com/users/${summary.user_id}" target="_blank" style="color: #7abfff;">
            ${summary.user_id}
          </a>
        </div>
        <div><strong>Mentions:</strong> ${summary.mention_count}</div>
        <div><strong>Birthday:</strong> ${summary.birthday || "Not set"}</div>
        <div><strong>Banned:</strong> ${summary.banned ? "‚úÖ Banned" : "‚ùå Not banned"}</div>
        ${summary.banned && summary.ban_reason ? `<div style="color: gray; font-size: 13px;">üìÑ Reason: ${summary.ban_reason}</div>` : ''}
        <div><strong>Muted:</strong> ${summary.muted ? "‚úÖ Muted" : "‚ùå Not muted"}</div>
        <div><strong>Mute Count:</strong> ${summary.mute_count > 0 ? summary.mute_count : "Never muted"}</div>
        ${summary.muted ? `
          <div style="color: gray; font-size: 13px; margin-top: 6px;">
            ‚è±Ô∏è Until: ${new Date(summary.mute_end).toLocaleDateString("en-GB")}<br>
            üìÑ Reason: ${summary.mute_reason || "No reason provided"}
          </div>` : summary.mute_end ? `
          <div style="color: gray; font-size: 13px; margin-top: 6px;">
            ‚è±Ô∏è Mute expired on: ${new Date(summary.mute_end).toLocaleDateString("en-GB")}<br>
            üìÑ Reason was: ${summary.mute_reason || "No reason provided"}
          </div>` : ''}
        <div style="margin-top: 10px;">
          ${muteButton}
          ${banButton}
          <button onclick="scamAction('${summary.user_id}', 'kick')">üë¢ Kick</button>
        </div>
      </div>
    </div>
  `;
}




  function renderScamRecords(records) {
    if (!records?.length) return "<p style='color: gray;'>No scam records found.</p>";

    return records.map((rec, i) => {
      const scamIDs = (rec.id || []).join(", ");
      const staffTag = rec.Staff ? `<@${rec.Staff}>` : "Unknown";

      return `
        <div style="margin-bottom: 16px;">
          <strong>Scam ID(s):</strong> ${scamIDs}<br>
          <strong>Added by:</strong> ${staffTag}<br>
          <div style="margin-top: 8px;">
            <button onclick="scamAction('${scamIDs}', 'add')">‚ûï Add to Scam List</button>
            <button onclick="scamAction('${scamIDs}', 'mute')">üîá Mute</button>
            <button onclick="scamAction('${scamIDs}', 'ban')">üî® Ban</button>
          </div>
        </div>
      `;
    }).join("");
  }


function renderVerificationEntries(entries) {
  if (!entries || !entries.length)
    return "<p style='color: gray;'>No verification attempts found.</p>";

  return `
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="border-bottom: 1px solid #555;">
          <th style="text-align: left; padding: 6px;">Hay Day ID</th>
          <th style="text-align: left; padding: 6px;">Farm Name</th>
          <th style="text-align: left; padding: 6px;">Level</th>
          <th style="text-align: left; padding: 6px;">Status</th>
          <th style="text-align: left; padding: 6px;">Submitted</th>
          <th style="text-align: left; padding: 6px;">Actions</th>
        </tr>
      </thead>
      <tbody>
        ${entries.map(entry => {
          const content = entry["Message content"] || "";
          const idMatch = content.match(/HayDay ID:\s*([#A-Z0-9]+)/i);
          const nameMatch = content.match(/Farm Name:\s*(.+)/i);
          const levelMatch = content.match(/level:\s*(\d+)/i);

          const haydayId = idMatch ? idMatch[1] : "Unknown";
          const farmName = nameMatch ? nameMatch[1] : "Unknown";
          const level = levelMatch ? levelMatch[1] : "Unknown";
          const submitted = entry.submitted_at
            ? new Date(entry.submitted_at).toLocaleString()
            : "Unknown";

          const status = entry.status;
          const color =
            status === "approve" ? "lime" : status === "pending" ? "gold" : "red";

          const isScammer = entry.is_scammer;
          const scamBtn = isScammer
            ? `<button onclick="scamConfirm('${haydayId}', 'remove')" style="background: #4a0000;">üö´ Remove Scam Tag</button>`
            : `<button onclick="scamConfirm('${haydayId}', 'add')">‚ûï Add to Scam List</button>`;

          const rowStyle = isScammer ? 'background: #320000;' : '';

          return `
            <tr style="border-bottom: 1px solid #333; ${rowStyle}">
              <td style="padding: 6px;">${haydayId}</td>
              <td style="padding: 6px;">${farmName}</td>
              <td style="padding: 6px;">${level}</td>
              <td style="padding: 6px; color: ${color}">${status}</td>
              <td style="padding: 6px;">${submitted}</td>
              <td style="padding: 6px;">${scamBtn}</td>
            </tr>
          `;
        }).join("")}
      </tbody>
    </table>
  `;
}


function scamConfirm(haydayId, action) {
  const confirmText = action === "add"
    ? `Are you sure you want to add ${haydayId} to the scam list?`
    : `Remove ${haydayId} from the scam list?`;

  if (!confirm(confirmText)) return;

  fetch("/api/moderation/scam", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      action: action,
      scam_id: haydayId
    })
  })
  .then(res => res.json())
  .then(result => {
    if (result.success) {
      alert(`‚úÖ Scam list updated`);
      performLookup();  // Refresh display
    } else {
      alert("‚ùå Error: " + result.error);
    }
  })
  .catch(err => {
    console.error("Scam update error:", err);
    alert("‚ùå Network or server error.");
  });
}


function renderCommands(commands) {
  if (!commands || !commands.length) return "<p style='color: gray;'>No commands used.</p>";

  return commands
    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))  // newest first
    .map(cmd => {
      const date = new Date(cmd.timestamp).toLocaleString();
      return `
        <div style="margin-bottom: 10px;">
          <strong>Command:</strong> ${cmd.command}<br>
          <strong>Time:</strong> ${date}<br>
          <strong>Used in:</strong> ${cmd.channel_id}
        </div>
      `;
    }).join("");
}

function renderRowCard(title, contentHTML, footerHTML = "") {
  return `
    <div class="wide-card">
      <div class="card-header">${title}</div>
      <div class="card-body">${contentHTML}</div>
      ${footerHTML ? `<div class="card-footer">${footerHTML}</div>` : ""}
    </div>
  `;
}


  async function performLookup() {
    const id = document.getElementById("lookupInput").value.trim();
    if (!id) return alert("Enter a valid ID");

    const res = await fetch(`/api/admin-lookup/${id}`);
    const data = await res.json();
    cachedData = data;

    const container = document.getElementById("results");
    container.innerHTML = "";

    if (data.error) {
      container.innerHTML = `<p style="color: red;">‚ùå ${data.error}</p>`;
      return;
    }

    container.innerHTML = `
      <div class="card-list">
        ${renderRowCard("üë§ User Summary", renderUserSummary(data.user_summary))}
        ${renderRowCard("üßæ Verification Attempts", renderVerificationEntries(data.linked_data))}
        <div class="wide-card">
          <div class="card-header">‚úè Message Edits</div>
          <div class="card-body card-body-edits"></div>
        </div>
        <div class="wide-card">
          <div class="card-header">üóë Message Deletes</div>
          <div class="card-body card-body-deletes"></div>
        </div>
        <div class="wide-card">
          <div class="card-header">üìõ Name Changes</div>
          <div class="card-body card-body-names"></div>
        </div>
        ${renderRowCard("‚å® Commands", renderCommands(data.commands))}
      </div>
    `;

    updateCardSection("edits");
    updateCardSection("deletes");
    updateCardSection("names");
  }

let originalMuteModalHTML = "";

document.addEventListener("DOMContentLoaded", () => {
  const modal = document.querySelector("#muteModal .modal-content");
  if (modal) {
    originalMuteModalHTML = modal.innerHTML;
  }
});


  </script>
{% endblock %}
